{{- 'room-pricing.css' | asset_url | stylesheet_tag -}}
{%- liquid
	assign section_heading = section.settings.heading
	assign section_heading_left = section.settings.heading_left
	assign full_width = section.settings.full_width
	assign columns_desktop = section.settings.columns_desktop
	assign heading_size = section.settings.heading_size
	assign mobile_swipe = section.settings.mobile_swipe
	assign image_ratio = section.settings.image_ratio
	assign show_progress_bar = section.settings.show_progress_bar
	assign disable_top_spacing = section.settings.disable_top_spacing
	assign disable_bottom_spacing = section.settings.disable_bottom_spacing
-%}
<div id="{{ section.id }}" class="room__pricing-section">
  <div class="row{% if full_width %} full-width-row{% endif %}">
    <div class="small-12 columns">
      {%- if section.settings.heading != blank -%}
        <h2 class="custom__heading text-center" style="color: {{ section.settings.heading_color }}">{{ section.settings.heading }}</h2>
      {%- endif -%}
      <div class="row align-stretch pricing__blocks-main {% if mobile_swipe %}mobile__swiper{% endif %}">
        {%- for block in section.blocks -%}
          <div id="content__{{ block.id }}" class="pricing__blocks" style="background-color: {{ block.settings.background_color }}">
            {% if block.settings.title != blank %}
              <h4 style="color: {{ block.settings.heading_color }}" class="{{ heading_size }} custom__{{ heading_size }} text-center">{{ block.settings.title | newline_to_br }}</h4>
            {% endif %}

            {% if block.settings.text != blank %}
              <div class="rte" {{ block.shopify_attributes }} style="color: {{ block.settings.text_color }}">{{ block.settings.text }}</div>
            {% endif %}
          </div>
        {%- endfor -%}
      </div>
      <div class="product-add-to-cart-sticky--content">
		{%- unless product.has_only_default_variant -%}
		<variant-selects  id="variant-selects-{{ section.id }}--sticky" class="no-js-hidden variant-selects--sticky" data-section="{{ section.id }}" data-url="{{ product.url }}" data-sticky="1" data-is-disabled="{{ is_disabled }}">
			<div class="variations">
				{%- for option in product.options_with_values -%}
					{%- liquid
						assign option_name = option.name | downcase | escape
						assign option_type = picker_type
						if color_picker
							if option_name contains 'color' or option_name contains 'colour' or option_name contains 'couleur'
								assign option_type = 'color'
							endif
						endif
					-%}
					{% render 'product-option', option_type: option_type, product: product, option: option, forloop: forloop, product_form_id: product_form_id, sticky: true %}
				{%- endfor -%}
			</div>
			<script type="application/json">
				{{ product.variants | json }}
			</script>
		</variant-selects>
		{%- endunless -%}
		{%- if product != blank -%}
		  <product-form class="product-form" data-sticky="1" data-section="{{ section.id }}">
				<div class="product-form__error-message-wrapper form-notification error" role="alert" hidden>
		      {% render 'svg-icons' with 'thb-error' %}
		      <span class="product-form__error-message"></span>
		    </div>
				<div class="product-add-to-cart-container">
					<div class="form-notification error" style="display:none;"></div>
				  <div class="add_to_cart_holder">
				    <button type="submit" name="add" id="AddToCartSticky" class="single-add-to-cart-button button outline {% unless product.selected_or_first_available_variant.available %}sold-out{% endunless %}" {% if product.selected_or_first_available_variant.available == false %}disabled{% endif %} form="{{ product_form_id }}">
                      <span class="single-add-to-cart-button--text">
						{%- if product.selected_or_first_available_variant.available -%}
				          {{ 'products.product.add_to_cart' | t }} 
				        {%- else -%}
				          {{ 'products.product.sold_out' | t }}
				        {%- endif -%}
                      </span>
                        <span class="loading-overlay">
                          {% render 'svg-icons' with 'thb-loading' %}
                        </span>
                        <span class="separator"> Â· </span>
                        <div id="price-btn-{{ section.id }}--sticky" class="sticky__add-to-cart">
                          {% render 'product-price', product: product, use_variant: true, show_badges: false %}
                        </div>
                    </button>
				  </div>
				</div>
			</product-form>
		{%- else -%}
	    <div class="product-form">
	      <div class="product-form__buttons form">
	        <button
	          type="submit"
	          name="add"
	          class="single_add_to_cart_button button sold-out"
	          disabled
	        >
	          <span class="single-add-to-cart-button--text">{{ 'products.product.sold_out' | t }}</span>
	        </button>
	      </div>
	    </div>
	  {%- endif -%}
	</div>
      
    </div>
  </div>
</div>

{% style %}

  #{{ section.id }} .row {
    background-color: {{ section.settings.section_bg }};
  }
  
{% endstyle %}

{% schema %}
{
  "name": "Room Pricing",
  "class": "room__pricing",
  "max_blocks": 3,
  "settings": [
    {
      "type": "color",
      "id": "section_bg",
      "label": "Section Background",
      "default": "#FFFDF9"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#333333"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Multicolumn"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Make section full width",
      "default": true
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Content heading size",
      "options": [
        {
          "value": "h3",
          "label": "Extra Large"
        },
        {
          "value": "h4",
          "label": "Large"
        },
        {
          "value": "h5",
          "label": "Medium"
        },
        {
          "value": "h6",
          "label": "Small"
        },
        {
          "value": "caption",
          "label": "Extra-Small"
        }
      ],
      "default": "h5"
    }
  ],
  "blocks": [
    {
      "type": "column",
      "name": "Column",
      "settings": [
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color",
          "default": "#F5F6F5"
        },
        {
          "type": "text",
          "id": "title",
          "default": "Column",
          "label": "Heading"
        },
        {
          "type": "color",
          "id": "heading_color",
          "label": "Heading Color",
          "default": "#333"
        },
        {
          "type": "richtext",
          "id": "text",
          "default": "<p>Pair text with an image to focus on your chosen product, collection, or blog post. Add details on availability, style, or even provide a review.</p>",
          "label": "Description"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "text Color",
          "default": "#333"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Room Pricing",
      "blocks": [
        {
          "type": "column"
        },
        {
          "type": "column"
        },
        {
          "type": "column"
        }
      ]
    }
  ]
}
{% endschema %}
